# LLM Edge Agent - Environment Configuration Template
# Week 1 Deployment: 5 Dependencies + OpenTelemetry 0.27
# Copy this file to .env and customize for your environment

#------------------------------------------------------------------------------
# SERVICE CONFIGURATION
#------------------------------------------------------------------------------
SERVICE_NAME=llm.edge-agent
SERVICE_VERSION=0.1.0
SERVICE_NAMESPACE=llm-devops
DEPLOYMENT_ENVIRONMENT=staging  # dev, staging, production

#------------------------------------------------------------------------------
# OPENTELEMETRY 0.27 CONFIGURATION
#------------------------------------------------------------------------------
# OTLP Exporter
OTEL_EXPORTER_OTLP_ENDPOINT=http://otlp-collector:4317
OTEL_EXPORTER_OTLP_PROTOCOL=grpc  # grpc or http/protobuf
OTEL_SERVICE_NAME=llm.edge-agent

# Resource Attributes (comma-separated key=value pairs)
OTEL_RESOURCE_ATTRIBUTES=service.namespace=llm-devops,deployment.environment=staging,service.version=0.1.0

# Sampling Configuration
OTEL_TRACES_SAMPLER=parentbased_always_on  # always_on, always_off, traceidratio, parentbased_always_on
OTEL_TRACES_SAMPLER_ARG=1.0  # For traceidratio sampler (0.0-1.0)

# Exporters
OTEL_METRICS_EXPORTER=otlp  # otlp, prometheus, none
OTEL_LOGS_EXPORTER=otlp     # otlp, none

# Batch Export Configuration
OTEL_BSP_SCHEDULE_DELAY=5000        # Batch span processor delay (ms)
OTEL_BSP_MAX_QUEUE_SIZE=2048        # Max queue size
OTEL_BSP_MAX_EXPORT_BATCH_SIZE=512  # Max batch size
OTEL_BSP_EXPORT_TIMEOUT=30000       # Export timeout (ms)

#------------------------------------------------------------------------------
# TRACING CONFIGURATION
#------------------------------------------------------------------------------
RUST_LOG=info,llm_edge_agent=debug,tower_http=debug
TRACING_ENABLED=true
TRACING_LEVEL=info  # trace, debug, info, warn, error
TRACING_FORMAT=json  # json, pretty, compact

#------------------------------------------------------------------------------
# REDIS CONFIGURATION (L2 Cache)
#------------------------------------------------------------------------------
REDIS_URL=redis://redis:6379
REDIS_POOL_SIZE=10
REDIS_TIMEOUT_MS=1000
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY_MS=100

#------------------------------------------------------------------------------
# APPLICATION CONFIGURATION
#------------------------------------------------------------------------------
HTTP_PORT=8080
METRICS_PORT=9091
HEALTH_CHECK_PORT=8080
WORKERS=4
MAX_CONNECTIONS=10000
REQUEST_TIMEOUT_MS=30000
GRACEFUL_SHUTDOWN_TIMEOUT_S=30

#------------------------------------------------------------------------------
# CACHE CONFIGURATION
#------------------------------------------------------------------------------
# L1 Cache (Moka - In-Memory)
L1_CACHE_SIZE=10000           # Maximum entries
L1_CACHE_TTL=300              # Time-to-live (seconds)
L1_CACHE_TTI=60               # Time-to-idle (seconds)

# L2 Cache (Redis)
L2_CACHE_ENABLED=true
L2_CACHE_TTL=3600             # Time-to-live (seconds)
L2_CACHE_KEY_PREFIX=llm-edge  # Key prefix in Redis

#------------------------------------------------------------------------------
# UPSTREAM DEPENDENCIES (Week 1: 5 enabled, Policy-Engine disabled)
#------------------------------------------------------------------------------
# Shield (Security Scanning)
SHIELD_ENABLED=true
SHIELD_URL=http://shield:8080
SHIELD_TIMEOUT_MS=5000

# Sentinel (Anomaly Detection)
SENTINEL_ENABLED=true
SENTINEL_URL=http://sentinel:8080
SENTINEL_TIMEOUT_MS=5000

# Observatory (Observability)
OBSERVATORY_ENABLED=true
OBSERVATORY_URL=http://observatory:8080
OBSERVATORY_TIMEOUT_MS=5000

# CostOps (Cost Management)
COST_OPS_ENABLED=true
COST_OPS_URL=http://cost-ops:8080
COST_OPS_TIMEOUT_MS=5000

# Connector-Hub (Provider Integrations)
CONNECTOR_HUB_ENABLED=true
CONNECTOR_HUB_URL=http://connector-hub:8080
CONNECTOR_HUB_TIMEOUT_MS=5000

# Policy-Engine (Policy Enforcement) - DISABLED WEEK 1, ENABLED WEEK 3
POLICY_ENGINE_ENABLED=false  # Set to true after Week 2 upgrade
POLICY_ENGINE_URL=http://policy-engine:8080
POLICY_ENGINE_TIMEOUT_MS=5000

#------------------------------------------------------------------------------
# ROUTING CONFIGURATION
#------------------------------------------------------------------------------
ROUTING_STRATEGY=cost  # cost, latency, failover
FAILOVER_ENABLED=true
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT_S=60

#------------------------------------------------------------------------------
# RATE LIMITING
#------------------------------------------------------------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_SECOND=1000
RATE_LIMIT_BURST_SIZE=2000

#------------------------------------------------------------------------------
# SECURITY
#------------------------------------------------------------------------------
TLS_ENABLED=false  # Enable for production
TLS_CERT_PATH=/certs/tls.crt
TLS_KEY_PATH=/certs/tls.key
JWT_SECRET=change-me-in-production  # IMPORTANT: Change for production!

#------------------------------------------------------------------------------
# MONITORING & ALERTING
#------------------------------------------------------------------------------
METRICS_ENABLED=true
HEALTH_CHECK_ENABLED=true
PROMETHEUS_METRICS_PATH=/metrics

#------------------------------------------------------------------------------
# KUBERNETES CONFIGURATION (Optional)
#------------------------------------------------------------------------------
# K8S_POD_NAME=${HOSTNAME}
# K8S_POD_NAMESPACE=llm-edge
# K8S_NODE_NAME=${NODE_NAME}
# K8S_CLUSTER_NAME=production-cluster
